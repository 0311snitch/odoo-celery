<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright Nova Code (http://www.novacode.nl)
License LGPL-3.0 or later (http://www.gnu.org/licenses/lgpl.html) -->

<odoo>
    <data>
        <record id="view_celery_task_report_tree" model="ir.ui.view">
            <field name="name">celery.task.report.tree</field>
            <field name="model">celery.task.report</field>
            <field name="arch" type="xml">
                <tree string="Celery Task Report" create="false" edit="false" delete="false"
                      default_order="id desc"
                      decoration-muted="state in ('SUCCESS', 'CANCEL')" decoration-danger="state == 'FAILURE'"
                      decoration-warning="jammed is True"
                      decoration-bf="state == 'JAMMED'">
                    <field name="task_id"/>
                    <field name="model"/>
                    <field name="method"/>
                    <field name="queue"/>
                    <field name="started_age_hours"/>
                    <field name="state_age_hours"/>
                    <field name="jammed"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

	<record id="view_celery_task_report_search" model="ir.ui.view">
	    <field name="name">celery.task.report.search</field>
	    <field name="model">celery.task.report</field>
	    <field name="type">search</field>
	    <field name="arch" type="xml">
		<search string="Celery Task Report">
                    <field name="task_id"/>
                    <field name="state"/>
                    <filter name="seems_jammed" string="Seems Jammed" domain="[('jammed','=',True)]"/>
		</search>
	    </field>
	</record>

        <!-- Action, menu -->
        <record id="action_celery_task_report" model="ir.actions.act_window">
            <field name="name">Celery Task Report</field>
            <field name="res_model">celery.task.report</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <!-- <field name="search_view_id" ref="view_cbf_shp_order_report_search"/> -->
        </record>

	<act_window
            id="action_celery_task_set_state_jammed"
            name="Update state to Jammed"
            src_model="celery.task.report" res_model="celery.task.handle.jammed"
            view_mode="form" view_type="form" view_id="view_celery_task_handle_jammed_form"
	    target="new" multi="False" key2="client_action_multi"/>
    </data>
</odoo>
